var MbnErr=function(p,x,g){this.toString=function(){return"Mbn"+p+" error: "+x+(void 0!==g?": "+g:"")}},MbnCr=function(p){var x=!1;"object"!==typeof p&&(p=void 0!==p?{MbnP:Number(p)}:{});var g=void 0===p.MbnP?2:Number(p.MbnP);if(!isFinite(g)||Math.round(g)!==g||0>g)throw new MbnErr("Cr","invalid precision",g);var y=void 0===p.MbnS?".":p.MbnS;if("."!==y&&","!==y)throw new MbnErr("Cr","invalid separator",y);var z=void 0===p.MbnT?!1:p.MbnT;if(!0!==z&&!1!==z)throw new MbnErr("Cr","invalid truncate",z);
var v=function(a){for(var d=a._d,b=d.length-1,c,e;0<=b;){for(c=d[b];0>c;)c+=10,d[b-1]--;e=c%10;c=(c-e)/10;d[b]=e;c?b?d[--b]+=c:d.unshift(c):b--}for(;d.length>g+1&&0===d[0];)d.shift();for(;d.length<g+1;)d.unshift(0);if(d.length===g+1){for(b=0;b<=g&&0===d[b];b++);a._s*=b<=g?1:0}},q=function(a,d,b){return!0===b?(a._d=d._d,a._s=d._s,a):d},w=function(a){r=a._d;2>r.length&&r.unshift(0);r[r.length-2]+=5<=r.pop()?1:0;v(a)},F=/^\s*([+=-]?)\s*/,G=/\s+$/,d=function(a,f){if(!(this instanceof d))return new d(a,
f);switch(typeof a){case "undefined":a=!1;case "boolean":a=Number(a);case "number":var b=a;if(!isFinite(b))throw new MbnErr("","invalid value",b);this._s=1;this._d=[];0>b&&(b=-b,this._s=-1);var c=Math.floor(b),b=b-c;do{var e=c%10,c=c-e,c=c/10;this._d.unshift(e)}while(0<c);for(c=0;c<=g;c++)b*=10,e=Math.floor(b),e=10===e?9:e,this._d.push(e),b-=e;w(this);break;case "object":if(a instanceof d){this.set(a);break}a=null!==a?a.toString():"0";case "string":a:{b=a;c=b.replace(F,"$1").replace(G,"");this._s=
1;this._d=[];e=c.charAt(0);if("-"===e||"+"===e||"="===e&&x)if(this._s="-"===e?-1:1,c=c.slice(1),"="===e){this.set(d.eval(c,f));break a}e=(c.indexOf(".")+1||c.indexOf(",")+1)-1;-1===e?e=c.length:c=c.slice(0,e)+c.slice(e+1);0===e&&(e=1,c="0"+c);for(var k,t=c.length,h=0;h<=e+g;h++)if(k=h<t?c.charCodeAt(h)-48:0,0<=k&&9>=k)this._d.push(k);else throw new MbnErr("","invalid format",b);w(this)}break;default:throw new MbnErr("","invalid argument",a);}};d.prop=function(){return{MbnV:"1.12",MbnP:g,MbnS:y,MbnT:z,
MbnE:x}};d.prototype.set=function(a){a instanceof d?(this._d=a._d.slice(),this._s=a._s):this.set(new d(a));return this};d.prototype.toString=function(){var a=this._d.length-g,d;if(z){d=a-1;for(var b=a;b<this._d.length;b++)0!==this._d[b]&&(d=b)}else d=a+g;b=(0>this._s?"-":"")+this._d.slice(0,a).join("");0!==g&&d>=a&&(b+=y+this._d.slice(a,d+1).join(""));return b};d.prototype.toNumber=function(){return Number(String(this).replace(",","."))};d.prototype.cmp=function(a,f){var b;if(void 0===f||0===(b=new d(f))._s){a instanceof
d||(a=new d(a));if(this._s!==a._s)return this._s>a._s?1:-1;if(0===this._s)return 0;b=this._d.length-a._d.length;if(0!==b)return 0<b?this._s:-this._s;for(b=0;b<this._d.length;b++)if(this._d[b]!==a._d[b])return this._d[b]>a._d[b]?this._s:-this._s;return 0}if(-1===b._s)throw new MbnErr(".cmp","negative maximal difference",b);return 0>=this.sub(a).abs().cmp(b)?0:this.cmp(a)};d.prototype.add=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0!==this._s)if(0===a._s)b.set(this);else if(a._s===
this._s){var c=this._d.length-a._d.length;0>c?(a=this,c=-c):b.set(this);for(var e=0;e<b._d.length;e++)e>=c&&(b._d[e]+=a._d[e-c]);v(b)}else b._s=-b._s,b.sub(this,!0),b._s=-b._s;return q(this,b,f)};d.prototype.sub=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0===this._s)b._s=-b._s;else if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length,e=this.cmp(a)*this._s;if(0===e)b=new d("0");else{-1===e?(a=this,c=-c):b.set(this);for(var k=0;k<b._d.length;k++)k>=c&&(b._d[k]-=
a._d[k-c]);b._s=e*this._s;v(b)}}else b._s=-b._s,b.add(this,!0);return q(this,b,f)};d.prototype.mul=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);b._d=[];for(var c=0;c<this._d.length;c++)for(var e=0;e<a._d.length;e++)b._d[c+e]=this._d[c]*a._d[e]+(b._d[c+e]||0);b._s=this._s*a._s;v(b);1<=g&&(1<g&&(b._d=b._d.slice(0,1-g)),w(b));return q(this,b,f)};d.prototype.div=function(a,f){a instanceof d||(a=new d(a));if(0===a._s)throw new MbnErr(".div","division by zero");if(0===this._s)return q(this,
new d(this),f);for(var b=this._d.slice(),c=a._d.slice(),e=0,k=[0];0===c[0];)c.shift();for(;0===b[0];)b.shift();for(var t=g+1;c.length<b.length;)c.push(0),t++;var h,m;do{for(;0===b[(h=b.length)-1]+c[(m=c.length)-1];)b.pop(),c.pop();var n=h>=m;if(h===m)for(var l=0;l<h;l++)if(b[l]!==c[l]){n=b[l]>c[l];break}if(n)for(k[e]++,h-=m,l=m-1;0<=l;l--)b[l+h]<c[l]?(b[l+h-1]--,b[l+h]+=10-c[l]):b[l+h]-=c[l];else b.push(0),e++,k[e]=0;for(;0===b[0];)b.shift()}while(0!==b.length&&e<=t);for(;e<=t;)k[++e]=0;k.pop();b=
new d(a);b._s*=this._s;b._d=k;w(b);return q(this,b,f)};d.prototype.mod=function(a,f){var b=a instanceof d?a.abs():(new d(a)).abs(),c=this.sub(this.div(b).intp().mul(b));0===c._s+this._s&&(c=b.sub(c.abs()),c._s=this._s);return q(this,c,f)};d.prototype.split=function(a){var f=[],b,c;void 0===a&&(a=2);if(a instanceof Array)for(b=new d(0),c=a.length,k=0;k<c;k++)f.push(new d(a[k])),b.add(f[k],!0);else{var e=new d(1);b=new d(a);if(!b.isInt()||0>b._s)throw new MbnErr(".split","only natural number of parts supported");
c=b.toNumber();for(var k=0;k<c;k++)f.push(e)}if(0===f.length)return[];a=new d(this);e=[];c--;for(k=0;k<c;k++){var g=a.mul(f[k]).div(b);b.sub(f[k],!0);a.sub(g,!0);e.push(g)}e.push(a);return e};d.prototype.isInt=function(){for(var a=this._d.length-g;a<this._d.length;a++)if(0!==this._d[a])return!1;return!0};d.prototype.floor=function(a){a=!0===a?this:new d(this);if(0!==g){for(var f=0,b=a._d.length-g;b<a._d.length;b++)f+=a._d[b],a._d[b]=0;-1===a._s&&0<f&&a._d[a._d.length-g-1]++;v(a)}return a};d.prototype.round=
function(a){a=!0===a?this:new d(this);if(0!==g){var f=a._d.length-g;for(a._d[f-1]+=5<=a._d[f]?1:0;f<a._d.length;)a._d[f++]=0;v(a)}return a};d.prototype.abs=function(a){a=!0===a?this:new d(this);a._s*=a._s;return a};d.prototype.inva=function(a){a=!0===a?this:new d(this);a._s=-a._s;return a};d.prototype.invm=function(a){return q(this,(new d(1)).div(this),a)};d.prototype.ceil=function(a){return(!0===a?this:new d(this)).inva(!0).floor(!0).inva(!0)};d.prototype.intp=function(a){a=!0===a?this:new d(this);
return 0<=a._s?a.floor(!0):a.ceil(!0)};d.prototype.eq=function(a,d){return 0===this.cmp(a,d)};d.prototype.min=function(a,f){return q(this,new d(0>=this.cmp(a)?this:a),f)};d.prototype.max=function(a,f){return q(this,new d(0<=this.cmp(a)?this:a),f)};d.prototype.sqrt=function(a){var f=new d(this);f._d.push(0);f._d.push(0);var b=new d(f),c=new d(f),e=new d(2);if(-1===c._s)throw new MbnErr(".sqrt","square root of negative number",this);if(1===c._s){do b.set(c),c.add(f.div(c),!0).div(e,!0);while(!b.eq(c))
}w(c);return q(this,c,a)};d.prototype.sgn=function(a){return q(this,new d(this._s),a)};x=!0;d.prototype.pow=function(a,f){var b=new d(a);if(!b.isInt())throw new MbnErr(".pow","only integer exponents supported",b);var c=b._s;b._s*=b._s;var e=new d(1),k=new d(2);-1===c&&-1===this.abs().cmp(e)&&(this.invm(!0),c=-c);for(var t=new d(this),h=0,m=0,n=new d(e);!t.isInt();)t._d.push(0),v(t),h++;for(;1===b._s;){b._d[b._d.length-g-1]%2&&(n.mul(t,!0),b.sub(e,!0),m+=h);b.div(k,!0).intp(!0);if(1!==b._s)break;t.mul(t,
!0);h*=2}1<=m&&(1<m&&(n._d=n._d.slice(0,1-m)),w(n));-1===c&&n.invm(!0);return q(this,n,f)};var E={abs:1,inva:1,invm:1,ceil:1,floor:1,sqrt:1,round:1,sgn:1,intp:1,add:2,mul:2,min:2,max:2};d.reduce=function(a,f){if(!E.hasOwnProperty(a))throw new MbnErr(".reduce","invalid function name",a);if(!(f instanceof Array))throw new MbnErr(".reduce","argument is not array",f);var b,c=f.length;if(1===E[a]){b=[];for(var e=0;e<c;e++)b.push((new d(f[e]))[a](!0))}else for(b=new d(0<c?f[0]:0),e=1;e<c;e++)b[a](f[e],
!0);return b};var u={PI:"3.1415926535897932384626433832795028841972",E:"2.7182818284590452353602874713526624977573",MbnP:g};d.PI=function(){return new d(u.PI)};d.E=function(){return new d(u.E)};d.MbnP=function(){return new d(u.MbnP)};var A={abs:!0,inva:!1,ceil:!0,floor:!0,sqrt:!0,round:!0,sgn:!0,"int":"intp"};p=["bop","pc"];var B=["num","name","uop","po"],H={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"]},C={num:{rx:/^([0-9\.,]+)\s*/,
next:p.concat("pr"),end:!0},name:{rx:/^([A-za-z_]\w*)\s*/},fn:{next:["po"],end:!1},vr:{next:p,end:!0},bop:{rx:/^([-+\*\/#^&|])\s*/,next:B,end:!1},uop:{rx:/^([-+])\s*/,next:B,end:!1},po:{rx:/^(\()\s*/,next:B,end:!1},pc:{rx:/^(\))\s*/,next:p,end:!0},pr:{rx:/^(%)\s*/,next:p,end:!0}};d.eval=function(a,f){a=a.replace(/^\s+/,"");var b={};if(void 0!==f)for(var c in f)f.hasOwnProperty(c)&&(b[c]=new d(f[c]));var e=B,k=e.length;c=!1;for(var g=[],h=[],m=!1,n=null,l,p=[4,!0,"inva"];0<a.length;){l=null;for(c=
0;c<k&&null===l;c++)n=e[c],l=a.match(C[n].rx);if(null===l)if("bop"===e[0])c="*",n="bop";else throw new MbnErr(".eval","unexpected",a);else c=l[1],a=a.slice(l[0].length);"uop"!==n&&m&&(h.push(p),m=!1);switch(n){case "num":g.push(new d(c));break;case "name":if(A.hasOwnProperty(c)&&!1!==A[c])n="fn",h.push([4,!0,c]);else if(b.hasOwnProperty(c))n="vr",g.push(new d(b[c]));else if(u.hasOwnProperty(c))n="vr",g.push(new d(u[c]));else throw new MbnErr(".eval","undefined",c);break;case "bop":for(c=H[c];-1!==
(e=h.length-1);)if(k=h[e],"("!==k&&k[0]>c[0]-(c[1]?1:0))g.push(h.pop()[2]);else break;h.push(c);break;case "uop":"-"===c&&(m=!m);break;case "po":h.push(c);break;case "pc":for(;-1!==(e=h.length-1);)if(k=h[e],"("!==k)g.push(h.pop()[2]);else{h.pop();break}if(-1===e)throw new MbnErr(".eval","unexpected",")");e=h.length-1;-1!==e&&4===h[e][2]&&g.push(h.pop()[2]);break;case "pr":g[g.length-1].div(100,!0)}e=C[n].next;k=e.length;c=C[n].end}for(;0!==h.length;)if(b=h.pop(),"("!==b)g.push(b[2]);else throw new MbnErr(".eval",
"unexpected","(");if(!c)throw new MbnErr(".eval","unexpected","END");h=[];b=g.length;for(c=0;c<b;c++)m=g[c],m instanceof d?h.push(m):A.hasOwnProperty(m)?("string"===typeof A[m]&&(m=A[m]),h[h.length-1][m](!0)):(n=h.pop(),h[h.length-1][m](n,!0));return h[0]};for(var D in u)u.hasOwnProperty(D)&&(u[D]=new d(u[D]));return d},Mbn=MbnCr();