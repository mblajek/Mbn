var MbnErr=function(l,g,q){this.toString=function(){return"Mbn"+l+" error: "+g+(void 0!==q?": "+q:"")}},MbnCr=function(l){"object"!==typeof l&&(l=void 0!==l?{MbnP:Number(l)}:{});var g=void 0===l.MbnP?2:Number(l.MbnP);if(!isFinite(g)||Math.round(g)!==g||0>g)throw new MbnErr("Cr","invalid precision",g);var q=void 0===l.MbnS?".":l.MbnS;if("."!==q&&","!==q)throw new MbnErr("Cr","invalid separator",q);var w=void 0===l.MbnT?!1:l.MbnT;if(!0!==w&&!1!==w)throw new MbnErr("Cr","invalid truncate",w);var t={PI:"3.1415926535897932384626433832795028841972",
E:"2.7182818284590452353602874713526624977573",MbnP:g},u=function(a){for(var d=a._d,b=d.length-1,c,e;0<=b;){for(c=d[b];0>c;)c+=10,d[b-1]--;e=c%10;c=(c-e)/10;d[b]=e;c?b?d[--b]+=c:d.unshift(c):b--}for(;d.length>g+1&&0===d[0];)d.shift();for(;d.length<g+1;)d.unshift(0);if(d.length===g+1){for(b=0;b<=g&&0===d[b];b++);a._s*=b<=g?1:0}},m=function(a,d,b){return!0===b?(a._d=d._d,a._s=d._s,a):d},v=function(a){r=a._d;2>r.length&&r.unshift(0);r[r.length-2]+=5<=r.pop()?1:0;u(a)},d=function(a,f){if(!(this instanceof
d))return new d(a,f);switch(typeof a){case "undefined":a=!1;case "boolean":a=Number(a);case "number":var b=a;if(!isFinite(b))throw new MbnErr("","invalid value",b);this._s=1;this._d=[];0>b&&(b=-b,this._s=-1);var c=Math.floor(b),b=b-c;do{var e=c%10,c=c-e,c=c/10;this._d.unshift(e)}while(0<c);for(c=0;c<=g;c++)b*=10,e=Math.floor(b),e=10===e?9:e,this._d.push(e),b-=e;v(this);break;case "object":if(a instanceof d){this.set(a);break}a=null!==a?a.toString():"0";case "string":a:{b=a;c=b.replace(/^\s*([+=-]?)\s*/,
"$1").replace(/\s+$/,"");this._s=1;this._d=[];e=c.charAt(0);if("-"===e||"+"===e||"="===e)if(this._s="-"===e?-1:1,c=c.slice(1),"="===e){this.set(d.eval(c,f));break a}e=(c.indexOf(".")+1||c.indexOf(",")+1)-1;-1===e?e=c.length:c=c.slice(0,e)+c.slice(e+1);0===e&&(e=1,c="0"+c);for(var h,x=c.length,k=0;k<=e+g;k++)if(h=k<x?c.charCodeAt(k)-48:0,0<=h&&9>=h)this._d.push(h);else throw new MbnErr("","invalid format",b);v(this)}break;default:throw new MbnErr("","invalid argument",a);}};d.prop=function(){return{MbnV:"1.10",
MbnP:g,MbnS:q,MbnT:w}};d.prototype.set=function(a){a instanceof d?(this._d=a._d.slice(),this._s=a._s):this.set(new d(a));return this};d.prototype.toString=function(){var a=this._d.length-g,d;if(w){d=a-1;for(var b=a;b<this._d.length;b++)0!==this._d[b]&&(d=b)}else d=a+g;b=(0>this._s?"-":"")+this._d.slice(0,a).join("");0!==g&&d>=a&&(b+=q+this._d.slice(a,d+1).join(""));return b};d.prototype.toNumber=function(){return Number(String(this).replace(",","."))};d.prototype.cmp=function(a,f){var b;if(void 0===
f||0===(b=new d(f))._s){a instanceof d||(a=new d(a));if(this._s!==a._s)return this._s>a._s?1:-1;if(0===this._s)return 0;b=this._d.length-a._d.length;if(0!==b)return 0<b?this._s:-this._s;for(b=0;b<this._d.length;b++)if(this._d[b]!==a._d[b])return this._d[b]>a._d[b]?this._s:-this._s;return 0}if(-1===b._s)throw new MbnErr(".cmp","negative maximal difference",b);return 0>=this.sub(a).abs().cmp(b)?0:this.cmp(a)};d.prototype.add=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0!==this._s)if(0===
a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length;0>c?(a=this,c=-c):b.set(this);for(var e=0;e<b._d.length;e++)e>=c&&(b._d[e]+=a._d[e-c]);u(b)}else b._s=-b._s,b.sub(this,!0),b._s=-b._s;return m(this,b,f)};d.prototype.sub=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0===this._s)b._s=-b._s;else if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length,e=this.cmp(a)*this._s;if(0===e)b=new d("0");else{-1===e?(a=this,c=-c):b.set(this);for(var h=
0;h<b._d.length;h++)h>=c&&(b._d[h]-=a._d[h-c]);b._s=e*this._s;u(b)}}else b._s=-b._s,b.add(this,!0);return m(this,b,f)};d.prototype.mul=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);b._d=[];for(var c=0;c<this._d.length;c++)for(var e=0;e<a._d.length;e++)b._d[c+e]=this._d[c]*a._d[e]+(b._d[c+e]||0);b._s=this._s*a._s;u(b);1<=g&&(1<g&&(b._d=b._d.slice(0,1-g)),v(b));return m(this,b,f)};d.prototype.div=function(a,f){a instanceof d||(a=new d(a));if(0===a._s)throw new MbnErr(".div","division by zero");
if(0===this._s)return m(this,new d(this),f);for(var b=this._d.slice(),c=a._d.slice(),e=0,h=[0];0===c[0];)c.shift();for(;0===b[0];)b.shift();for(var x=g+1;c.length<b.length;)c.push(0),x++;var k,p;do{for(;0===b[(k=b.length)-1]+c[(p=c.length)-1];)b.pop(),c.pop();var l=k>=p;if(k===p)for(var n=0;n<k;n++)if(b[n]!==c[n]){l=b[n]>c[n];break}if(l)for(h[e]++,k-=p,n=p-1;0<=n;n--)b[n+k]<c[n]?(b[n+k-1]--,b[n+k]+=10-c[n]):b[n+k]-=c[n];else b.push(0),e++,h[e]=0;for(;0===b[0];)b.shift()}while(0!==b.length&&e<=x);
for(;e<=x;)h[++e]=0;h.pop();b=new d(a);b._s*=this._s;b._d=h;v(b);return m(this,b,f)};d.prototype.mod=function(a,f){var b=a instanceof d?a.abs():(new d(a)).abs(),c=this.sub(this.div(b)["int"]().mul(b));0===c._s+this._s&&(c=b.sub(c.abs()),c._s=this._s);return m(this,c,f)};d.prototype.split=function(a){var f=[],b,c;void 0===a&&(a=2);if(a instanceof Array)for(b=new d(0),c=a.length,h=0;h<c;h++)f.push(new d(a[h])),b.add(f[h],!0);else{var e=new d(1);b=new d(a);if(!b.isInt()||0>b._s)throw new MbnErr(".split",
"only natural number of parts supported");c=b.toNumber();for(var h=0;h<c;h++)f.push(e)}if(0===f.length)return[];a=new d(this);e=[];c--;for(h=0;h<c;h++){var g=a.mul(f[h]).div(b);b.sub(f[h],!0);a.sub(g,!0);e.push(g)}e.push(a);return e};d.prototype.isInt=function(){for(var a=this._d.length-g;a<this._d.length;a++)if(0!==this._d[a])return!1;return!0};d.prototype.pow=function(a,f){a=new d(a);if(!a.isInt())throw new MbnErr(".pow","only integer exponents supported");var b=a._s;a._s*=a._s;for(var c=new d(this),
e=0,h=0,l=new d(1),k=new d(2),p=new d(l);!c.isInt();)c._d.push(0),u(c),e++;for(;1===a._s;){a._d[a._d.length-g-1]%2&&(p.mul(c,!0),a.sub(l,!0),h+=e);a.div(k,!0)["int"](!0);if(1!==a._s)break;c.mul(c,!0);e*=2}1<=h&&(1<h&&(p._d=p._d.slice(0,1-h)),v(p));-1===b&&p.invm(!0);return m(this,p,f)};d.prototype.floor=function(a){a=!0===a?this:new d(this);if(0!==g){for(var f=0,b=a._d.length-g;b<a._d.length;b++)f+=a._d[b],a._d[b]=0;-1===a._s&&0<f&&a._d[a._d.length-g-1]++;u(a)}return a};d.prototype.round=function(a){a=
!0===a?this:new d(this);if(0!==g){var f=a._d.length-g;for(a._d[f-1]+=5<=a._d[f]?1:0;f<a._d.length;)a._d[f++]=0;u(a)}return a};d.prototype.abs=function(a){a=!0===a?this:new d(this);a._s*=a._s;return a};d.prototype.inva=function(a){a=!0===a?this:new d(this);a._s=-a._s;return a};d.prototype.invm=function(a){return m(this,(new d(1)).div(this),a)};d.prototype.ceil=function(a){return(!0===a?this:new d(this)).inva(!0).floor(!0).inva(!0)};d.prototype["int"]=function(a){a=!0===a?this:new d(this);return 0<=
a._s?a.floor(!0):a.ceil(!0)};d.prototype.eq=function(a,d){return 0===this.cmp(a,d)};d.prototype.min=function(a,f){return m(this,new d(0>=this.cmp(a)?this:a),f)};d.prototype.max=function(a,f){return m(this,new d(0<=this.cmp(a)?this:a),f)};d.prototype.sqrt=function(a){var f=new d(this);f._d.push(0);f._d.push(0);var b=new d(f),c=new d(f),e=new d(2);if(-1===c._s)throw new MbnErr(".sqrt","square root of negative number",this);if(1===c._s){do b.set(c),c.add(f.div(c),!0).div(e,!0);while(!b.eq(c))}v(c);return m(this,
c,a)};d.prototype.sgn=function(a){return m(this,new d(this._s),a)};d.PI=function(){return new d(t.PI)};d.E=function(){return new d(t.E)};d.MbnP=function(){return new d(t.MbnP)};var z={abs:1,inva:2,ceil:1,floor:1,invm:2,sqrt:1,round:1,sgn:1,"int":1};l=["bop","pc"];var y=["num","name","uop","po"],C={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"]},A={num:{rx:/^([0-9\.,]+)\s*/,next:l.concat("pr"),end:!0},name:{rx:/^([A-za-z_]\w*)\s*/},
fn:{next:["po"],end:!1},vr:{next:l,end:!0},bop:{rx:/^([-+\*\/#^&|])\s*/,next:y,end:!1},uop:{rx:/^([-+])\s*/,next:y,end:!1},po:{rx:/^(\()\s*/,next:y,end:!1},pc:{rx:/^(\))\s*/,next:l,end:!0},pr:{rx:/^(%)\s*/,next:l,end:!0}};d.eval=function(a,f){a=a.replace(/^\s+/,"");var b={};if(void 0!==f)for(var c in f)f.hasOwnProperty(c)&&(b[c]=new d(f[c]));var e=y,h=e.length;c=!1;for(var g=[],k=[],l=!1,m=null,n,q=[4,!0,"inva"];0<a.length;){n=null;for(c=0;c<h&&null===n;c++)m=e[c],n=a.match(A[m].rx);if(null===n)if("bop"===
e[0])c="*",m="bop";else throw new MbnErr(".eval","unexpected",a);else c=n[1],a=a.slice(n[0].length);"uop"!==m&&l&&(k.push(q),l=!1);switch(m){case "num":g.push(new d(c));break;case "name":if(z.hasOwnProperty(c)&&1===z[c])m="fn",k.push([4,!0,c]);else if(b.hasOwnProperty(c))m="vr",g.push(new d(b[c]));else if(t.hasOwnProperty(c))m="vr",g.push(new d(t[c]));else throw new MbnErr(".eval","undefined",c);break;case "bop":for(c=C[c];-1!==(e=k.length-1);)if(h=k[e],"("!==h&&h[0]>c[0]-(c[1]?1:0))g.push(k.pop()[2]);
else break;k.push(c);break;case "uop":"-"===c&&(l=!l);break;case "po":k.push(c);break;case "pc":for(;-1!==(e=k.length-1);)if(h=k[e],"("!==h)g.push(k.pop()[2]);else{k.pop();break}if(-1===e)throw new MbnErr(".eval","unexpected",")");e=k.length-1;-1!==e&&4===k[e][2]&&g.push(k.pop()[2]);break;case "pr":g[g.length-1].div(100,!0)}e=A[m].next;h=e.length;c=A[m].end}for(;0!==k.length;)if(b=k.pop(),"("!==b)g.push(b[2]);else throw new MbnErr(".eval","unexpected","(");if(!c)throw new MbnErr(".eval","unexpected",
"END");k=[];b=g.length;for(c=0;c<b;c++)if(l=g[c],l instanceof d)k.push(l);else if(z.hasOwnProperty(l))k[k.length-1][l](!0);else m=k.pop(),k[k.length-1][l](m,!0);return k[0]};for(var B in t)t.hasOwnProperty(B)&&(t[B]=new d(t[B]));return d},Mbn=MbnCr();