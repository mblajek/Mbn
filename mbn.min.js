var MbnErr=function(l,h,u){this.toString=function(){return"Mbn"+l+" error: "+h+(void 0!==u?": "+u:"")}},MbnCr=function(l){"object"!==typeof l&&(l=void 0!==l?{MbnP:Number(l)}:{});var h=void 0===l.MbnP?2:Number(l.MbnP);if(!isFinite(h)||Math.round(h)!==h||0>h)throw new MbnErr("Cr","invalid precision",h);var u=void 0===l.MbnS?".":l.MbnS;if("."!==u&&","!==u)throw new MbnErr("Cr","invalid separator",u);var x=void 0===l.MbnT?!1:l.MbnT;if(!0!==x&&!1!==x)throw new MbnErr("Cr","invalid truncate",x);var q={PI:"3.1415926535897932384626433832795028841972",
E:"2.7182818284590452353602874713526624977573",MbnP:h},v=function(a){for(var d=a._d,b=d.length-1,c,e;0<=b;){for(c=d[b];0>c;)c+=10,d[b-1]--;e=c%10;c=(c-e)/10;d[b]=e;c?b?d[--b]+=c:d.unshift(c):b--}for(;d.length>h+1&&0===d[0];)d.shift();for(;d.length<h+1;)d.unshift(0);if(d.length===h+1){for(b=0;b<=h&&0===d[b];b++);a._s*=b<=h?1:0}},p=function(a,d,b){return!0===b?(a._d=d._d,a._s=d._s,a):d},w=function(a){r=a._d;2>r.length&&r.unshift(0);r[r.length-2]+=5<=r.pop()?1:0;v(a)},d=function(a,f){if(!(this instanceof
d))return new d(a,f);switch(typeof a){case "undefined":a=!1;case "boolean":a=Number(a);case "number":var b=a;if(!isFinite(b))throw new MbnErr("","invalid value",b);this._s=1;this._d=[];0>b&&(b=-b,this._s=-1);var c=Math.floor(b),b=b-c;do{var e=c%10,c=c-e,c=c/10;this._d.unshift(e)}while(0<c);for(c=0;c<=h;c++)b*=10,e=Math.floor(b),e=10===e?9:e,this._d.push(e),b-=e;w(this);break;case "object":if(a instanceof d){this.set(a);break}a=null!==a?a.toString():"0";case "string":a:{b=a;c=b.replace(/^\s*([+=-]?)\s*/,
"$1").replace(/\s+$/,"");this._s=1;this._d=[];e=c.charAt(0);if("-"===e||"+"===e||"="===e)if(this._s="-"===e?-1:1,c=c.slice(1),"="===e){this.set(d.eval(c,f));break a}e=(c.indexOf(".")+1||c.indexOf(",")+1)-1;-1===e?e=c.length:c=c.slice(0,e)+c.slice(e+1);0===e&&(e=1,c="0"+c);for(var k,t=c.length,g=0;g<=e+h;g++)if(k=g<t?c.charCodeAt(g)-48:0,0<=k&&9>=k)this._d.push(k);else throw new MbnErr("","invalid format",b);w(this)}break;default:throw new MbnErr("","invalid argument",a);}};d.prop=function(){return{MbnV:"1.10",
MbnP:h,MbnS:u,MbnT:x}};d.prototype.set=function(a){a instanceof d?(this._d=a._d.slice(),this._s=a._s):this.set(new d(a));return this};d.prototype.toString=function(){var a=this._d.length-h,d;if(x){d=a-1;for(var b=a;b<this._d.length;b++)0!==this._d[b]&&(d=b)}else d=a+h;b=(0>this._s?"-":"")+this._d.slice(0,a).join("");0!==h&&d>=a&&(b+=u+this._d.slice(a,d+1).join(""));return b};d.prototype.toNumber=function(){return Number(String(this).replace(",","."))};d.prototype.cmp=function(a,f){var b;if(void 0===
f||0===(b=new d(f))._s){a instanceof d||(a=new d(a));if(this._s!==a._s)return this._s>a._s?1:-1;if(0===this._s)return 0;b=this._d.length-a._d.length;if(0!==b)return 0<b?this._s:-this._s;for(b=0;b<this._d.length;b++)if(this._d[b]!==a._d[b])return this._d[b]>a._d[b]?this._s:-this._s;return 0}if(-1===b._s)throw new MbnErr(".cmp","negative maximal difference",b);return 0>=this.sub(a).abs().cmp(b)?0:this.cmp(a)};d.prototype.add=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0!==this._s)if(0===
a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length;0>c?(a=this,c=-c):b.set(this);for(var e=0;e<b._d.length;e++)e>=c&&(b._d[e]+=a._d[e-c]);v(b)}else b._s=-b._s,b.sub(this,!0),b._s=-b._s;return p(this,b,f)};d.prototype.sub=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0===this._s)b._s=-b._s;else if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length,e=this.cmp(a)*this._s;if(0===e)b=new d("0");else{-1===e?(a=this,c=-c):b.set(this);for(var k=
0;k<b._d.length;k++)k>=c&&(b._d[k]-=a._d[k-c]);b._s=e*this._s;v(b)}}else b._s=-b._s,b.add(this,!0);return p(this,b,f)};d.prototype.mul=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);b._d=[];for(var c=0;c<this._d.length;c++)for(var e=0;e<a._d.length;e++)b._d[c+e]=this._d[c]*a._d[e]+(b._d[c+e]||0);b._s=this._s*a._s;v(b);1<=h&&(1<h&&(b._d=b._d.slice(0,1-h)),w(b));return p(this,b,f)};d.prototype.div=function(a,f){a instanceof d||(a=new d(a));if(0===a._s)throw new MbnErr(".div","division by zero");
if(0===this._s)return p(this,new d(this),f);for(var b=this._d.slice(),c=a._d.slice(),e=0,k=[0];0===c[0];)c.shift();for(;0===b[0];)b.shift();for(var t=h+1;c.length<b.length;)c.push(0),t++;var g,n;do{for(;0===b[(g=b.length)-1]+c[(n=c.length)-1];)b.pop(),c.pop();var l=g>=n;if(g===n)for(var m=0;m<g;m++)if(b[m]!==c[m]){l=b[m]>c[m];break}if(l)for(k[e]++,g-=n,m=n-1;0<=m;m--)b[m+g]<c[m]?(b[m+g-1]--,b[m+g]+=10-c[m]):b[m+g]-=c[m];else b.push(0),e++,k[e]=0;for(;0===b[0];)b.shift()}while(0!==b.length&&e<=t);
for(;e<=t;)k[++e]=0;k.pop();b=new d(a);b._s*=this._s;b._d=k;w(b);return p(this,b,f)};d.prototype.mod=function(a,f){var b=a instanceof d?a.abs():(new d(a)).abs(),c=this.sub(this.div(b)["int"]().mul(b));0===c._s+this._s&&(c=b.sub(c.abs()),c._s=this._s);return p(this,c,f)};d.prototype.split=function(a){var f=[],b,c;void 0===a&&(a=2);if(a instanceof Array)for(b=new d(0),c=a.length,k=0;k<c;k++)f.push(new d(a[k])),b.add(f[k],!0);else{var e=new d(1);b=new d(a);if(!b.isInt()||0>b._s)throw new MbnErr(".split",
"only natural number of parts supported");c=b.toNumber();for(var k=0;k<c;k++)f.push(e)}if(0===f.length)return[];a=new d(this);e=[];c--;for(k=0;k<c;k++){var h=a.mul(f[k]).div(b);b.sub(f[k],!0);a.sub(h,!0);e.push(h)}e.push(a);return e};d.prototype.isInt=function(){for(var a=this._d.length-h;a<this._d.length;a++)if(0!==this._d[a])return!1;return!0};d.prototype.pow=function(a,f){a=new d(a);if(!a.isInt())throw new MbnErr(".pow","only integer exponents supported",a);var b=a._s;a._s*=a._s;var c=new d(1),
e=new d(2);-1===b&&-1===this.abs().cmp(c)&&this.eq(this.invm().invm())&&(this.invm(!0),b=-b);for(var k=new d(this),t=0,g=0,n=new d(c);!k.isInt();)k._d.push(0),v(k),t++;for(;1===a._s;){a._d[a._d.length-h-1]%2&&(n.mul(k,!0),a.sub(c,!0),g+=t);a.div(e,!0)["int"](!0);if(1!==a._s)break;k.mul(k,!0);t*=2}1<=g&&(1<g&&(n._d=n._d.slice(0,1-g)),w(n));-1===b&&n.invm(!0);return p(this,n,f)};d.prototype.floor=function(a){a=!0===a?this:new d(this);if(0!==h){for(var f=0,b=a._d.length-h;b<a._d.length;b++)f+=a._d[b],
a._d[b]=0;-1===a._s&&0<f&&a._d[a._d.length-h-1]++;v(a)}return a};d.prototype.round=function(a){a=!0===a?this:new d(this);if(0!==h){var f=a._d.length-h;for(a._d[f-1]+=5<=a._d[f]?1:0;f<a._d.length;)a._d[f++]=0;v(a)}return a};d.prototype.abs=function(a){a=!0===a?this:new d(this);a._s*=a._s;return a};d.prototype.inva=function(a){a=!0===a?this:new d(this);a._s=-a._s;return a};d.prototype.invm=function(a){return p(this,(new d(1)).div(this),a)};d.prototype.ceil=function(a){return(!0===a?this:new d(this)).inva(!0).floor(!0).inva(!0)};
d.prototype["int"]=function(a){a=!0===a?this:new d(this);return 0<=a._s?a.floor(!0):a.ceil(!0)};d.prototype.eq=function(a,d){return 0===this.cmp(a,d)};d.prototype.min=function(a,f){return p(this,new d(0>=this.cmp(a)?this:a),f)};d.prototype.max=function(a,f){return p(this,new d(0<=this.cmp(a)?this:a),f)};d.prototype.sqrt=function(a){var f=new d(this);f._d.push(0);f._d.push(0);var b=new d(f),c=new d(f),e=new d(2);if(-1===c._s)throw new MbnErr(".sqrt","square root of negative number",this);if(1===c._s){do b.set(c),
c.add(f.div(c),!0).div(e,!0);while(!b.eq(c))}w(c);return p(this,c,a)};d.prototype.sgn=function(a){return p(this,new d(this._s),a)};d.PI=function(){return new d(q.PI)};d.E=function(){return new d(q.E)};d.MbnP=function(){return new d(q.MbnP)};var z={abs:1,inva:2,ceil:1,floor:1,invm:2,sqrt:1,round:1,sgn:1,"int":1};l=["bop","pc"];var y=["num","name","uop","po"],C={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"]},A=
{num:{rx:/^([0-9\.,]+)\s*/,next:l.concat("pr"),end:!0},name:{rx:/^([A-za-z_]\w*)\s*/},fn:{next:["po"],end:!1},vr:{next:l,end:!0},bop:{rx:/^([-+\*\/#^&|])\s*/,next:y,end:!1},uop:{rx:/^([-+])\s*/,next:y,end:!1},po:{rx:/^(\()\s*/,next:y,end:!1},pc:{rx:/^(\))\s*/,next:l,end:!0},pr:{rx:/^(%)\s*/,next:l,end:!0}};d.eval=function(a,f){a=a.replace(/^\s+/,"");var b={};if(void 0!==f)for(var c in f)f.hasOwnProperty(c)&&(b[c]=new d(f[c]));var e=y,k=e.length;c=!1;for(var h=[],g=[],n=!1,l=null,m,p=[4,!0,"inva"];0<
a.length;){m=null;for(c=0;c<k&&null===m;c++)l=e[c],m=a.match(A[l].rx);if(null===m)if("bop"===e[0])c="*",l="bop";else throw new MbnErr(".eval","unexpected",a);else c=m[1],a=a.slice(m[0].length);"uop"!==l&&n&&(g.push(p),n=!1);switch(l){case "num":h.push(new d(c));break;case "name":if(z.hasOwnProperty(c)&&1===z[c])l="fn",g.push([4,!0,c]);else if(b.hasOwnProperty(c))l="vr",h.push(new d(b[c]));else if(q.hasOwnProperty(c))l="vr",h.push(new d(q[c]));else throw new MbnErr(".eval","undefined",c);break;case "bop":for(c=
C[c];-1!==(e=g.length-1);)if(k=g[e],"("!==k&&k[0]>c[0]-(c[1]?1:0))h.push(g.pop()[2]);else break;g.push(c);break;case "uop":"-"===c&&(n=!n);break;case "po":g.push(c);break;case "pc":for(;-1!==(e=g.length-1);)if(k=g[e],"("!==k)h.push(g.pop()[2]);else{g.pop();break}if(-1===e)throw new MbnErr(".eval","unexpected",")");e=g.length-1;-1!==e&&4===g[e][2]&&h.push(g.pop()[2]);break;case "pr":h[h.length-1].div(100,!0)}e=A[l].next;k=e.length;c=A[l].end}for(;0!==g.length;)if(b=g.pop(),"("!==b)h.push(b[2]);else throw new MbnErr(".eval",
"unexpected","(");if(!c)throw new MbnErr(".eval","unexpected","END");g=[];b=h.length;for(c=0;c<b;c++)if(n=h[c],n instanceof d)g.push(n);else if(z.hasOwnProperty(n))g[g.length-1][n](!0);else l=g.pop(),g[g.length-1][n](l,!0);return g[0]};for(var B in q)q.hasOwnProperty(B)&&(q[B]=new d(q[B]));return d},Mbn=MbnCr();