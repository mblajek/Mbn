var MbnErr=function(p,g,q){this.toString=function(){var u="Mbn"+p+" error: "+g;void 0!==q&&(q=String(q),u+=": "+(10<q.length?q.slice(0,8)+"..":q));return u}},MbnCr=function(p){"object"!==typeof p&&(p=void 0!==p?{MbnP:Number(p)}:{});var g=void 0===p.MbnP?2:Number(p.MbnP);if(!isFinite(g)||Math.round(g)!==g||0>g)throw new MbnErr("Cr","invalid precision",g);var q=void 0===p.MbnS?".":p.MbnS;if("."!==q&&","!==q)throw new MbnErr("Cr","invalid separator",q);var u=void 0===p.MbnT?!1:p.MbnT;if(!0!==u&&!1!==
u)throw new MbnErr("Cr","invalid truncate",u);var v=function(a){for(var d=a._d,b=d.length-1,c,e;0<=b;){for(c=d[b];0>c;)c+=10,d[b-1]--;e=c%10;c=(c-e)/10;d[b]=e;0!==c?0!==b?d[--b]+=c:d.unshift(c):b--}for(;d.length>g+1&&0===d[0];)d.shift();for(;d.length<g+1;)d.unshift(0);if(d.length===g+1){for(b=0;b<=g&&0===d[b];b++);a._s*=b<=g?1:0}},r=function(a,d,b){return!0===b?(a._d=d._d,a._s=d._s,a):d},w=function(a){var d=a._d;2>d.length&&d.unshift(0);5<=d.pop()&&d[d.length-1]++;v(a)},C=/^\s*([+=-]?)\s*/,D=/\s+$/,
e=function(a,d){if(!(this instanceof e))return new e(a,d);switch(typeof a){case "undefined":a=!1;case "boolean":a=Number(a);case "number":var b=a;if(!isFinite(b))throw new MbnErr("","invalid value",b);this._s=1;this._d=[];0>b&&(b=-b,this._s=-1);var c=Math.floor(b),b=b-c;do{var f=c%10,c=c-f,c=c/10;this._d.unshift(f)}while(0<c);for(c=0;c<=g;c++)b*=10,f=Math.floor(b),f=10===f?9:f,this._d.push(f),b-=f;w(this);break;case "object":if(a instanceof e){this.set(a);break}a=null!==a?a.toString():"0";case "string":a:{b=
a;c=b.replace(C,"$1").replace(D,"");this._s=1;this._d=[];f=c.charAt(0);if("-"===f||"+"===f||"="===f)if(this._s="-"===f?-1:1,c=c.slice(1),"="===f){this.set("function"===typeof e.eval?e.eval(c,d):new e(c));break a}f=(c.indexOf(".")+1||c.indexOf(",")+1)-1;-1===f?f=c.length:c=c.slice(0,f)+c.slice(f+1);0===f&&(f=1,c="0"+c);for(var k,t=c.length,h=0;h<=f+g;h++)if(k=h<t?c.charCodeAt(h)-48:0,0<=k&&9>=k)this._d.push(k);else throw new MbnErr("","invalid format",b);w(this)}break;default:throw new MbnErr("","invalid argument",
a);}};e.prop=function(){return{MbnV:"1.14",MbnP:g,MbnS:q,MbnT:u,MbnE:"function"===typeof e.eval}};e.prototype.set=function(a){a instanceof e?(this._d=a._d.slice(),this._s=a._s):this.set(new e(a));return this};e.prototype.toString=function(){var a=this._d.length-g,d;if(u){d=a-1;for(var b=a;b<this._d.length;b++)0!==this._d[b]&&(d=b)}else d=a+g;b=(0>this._s?"-":"")+this._d.slice(0,a).join("");0!==g&&d>=a&&(b+=q+this._d.slice(a,d+1).join(""));return b};e.prototype.toNumber=function(){return Number(String(this).replace(",",
"."))};e.prototype.cmp=function(a,d){var b;if(void 0===d||0===(b=new e(d))._s){a instanceof e||(a=new e(a));if(this._s!==a._s)return this._s>a._s?1:-1;if(0===this._s)return 0;b=this._d.length-a._d.length;if(0!==b)return 0<b?this._s:-this._s;for(b=0;b<this._d.length;b++)if(this._d[b]!==a._d[b])return this._d[b]>a._d[b]?this._s:-this._s;return 0}if(-1===b._s)throw new MbnErr(".cmp","negative maximal difference",b);return 0>=this.sub(a).abs().cmp(b)?0:this.cmp(a)};e.prototype.add=function(a,d){a instanceof
e||(a=new e(a));var b=new e(a);if(0!==this._s)if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length;0>c?(a=this,c=-c):b.set(this);for(var f=0;f<b._d.length;f++)f>=c&&(b._d[f]+=a._d[f-c]);v(b)}else b._s=-b._s,b.sub(this,!0),b._s=-b._s;return r(this,b,d)};e.prototype.sub=function(a,d){a instanceof e||(a=new e(a));var b=new e(a);if(0===this._s)b._s=-b._s;else if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length,f=this.cmp(a)*this._s;if(0===f)b=new e("0");
else{-1===f?(a=this,c=-c):b.set(this);for(var k=0;k<b._d.length;k++)k>=c&&(b._d[k]-=a._d[k-c]);b._s=f*this._s;v(b)}}else b._s=-b._s,b.add(this,!0);return r(this,b,d)};e.prototype.mul=function(a,d){a instanceof e||(a=new e(a));var b=new e(a);b._d=[];for(var c=0;c<this._d.length;c++)for(var f=0;f<a._d.length;f++)b._d[c+f]=this._d[c]*a._d[f]+(b._d[c+f]||0);b._s=this._s*a._s;v(b);1<=g&&(1<g&&(b._d=b._d.slice(0,1-g)),w(b));return r(this,b,d)};e.prototype.div=function(a,d){a instanceof e||(a=new e(a));
if(0===a._s)throw new MbnErr(".div","division by zero");if(0===this._s)return r(this,new e(this),d);for(var b=this._d.slice(),c=a._d.slice(),f=0,k=[0];0===c[0];)c.shift();for(;0===b[0];)b.shift();for(var t=g+1;c.length<b.length;)c.push(0),t++;var h,m;do{for(;0===b[(h=b.length)-1]+c[(m=c.length)-1];)b.pop(),c.pop();var n=h>=m;if(h===m)for(var l=0;l<h;l++)if(b[l]!==c[l]){n=b[l]>c[l];break}if(n)for(k[f]++,h-=m,l=m-1;0<=l;l--)b[l+h]<c[l]?(b[l+h-1]--,b[l+h]+=10-c[l]):b[l+h]-=c[l];else b.push(0),f++,k[f]=
0;for(;0===b[0];)b.shift()}while(0!==b.length&&f<=t);for(;f<=t;)k[++f]=0;k.pop();b=new e(a);b._s*=this._s;b._d=k;w(b);return r(this,b,d)};e.prototype.mod=function(a,d){var b=a instanceof e?a.abs():(new e(a)).abs(),c=this.sub(this.div(b).intp().mul(b));0===c._s+this._s&&(c=b.sub(c.abs()),c._s=this._s);return r(this,c,d)};e.prototype.split=function(a){var d=[],b,c;void 0===a&&(a=2);if(a instanceof Array)for(b=new e(0),c=a.length,k=0;k<c;k++)d.push(new e(a[k])),b.add(d[k],!0);else{var f=new e(1);b=new e(a);
if(!b.isInt()||0>b._s)throw new MbnErr(".split","only natural number of parts supported");c=b.toNumber();for(var k=0;k<c;k++)d.push(f)}if(0===d.length)return[];a=new e(this);f=[];c--;for(k=0;k<c;k++){var g=a.mul(d[k]).div(b);b.sub(d[k],!0);a.sub(g,!0);f.push(g)}f.push(a);return f};e.prototype.isInt=function(){for(var a=this._d.length-g;a<this._d.length;a++)if(0!==this._d[a])return!1;return!0};e.prototype.floor=function(a){a=!0===a?this:new e(this);if(0!==g){for(var d=0,b=a._d.length-g;b<a._d.length;b++)d+=
a._d[b],a._d[b]=0;-1===a._s&&0<d&&a._d[a._d.length-g-1]++;v(a)}return a};e.prototype.round=function(a){a=!0===a?this:new e(this);if(0!==g){var d=a._d.length-g;for(a._d[d-1]+=5<=a._d[d]?1:0;d<a._d.length;)a._d[d++]=0;v(a)}return a};e.prototype.abs=function(a){a=!0===a?this:new e(this);a._s*=a._s;return a};e.prototype.inva=function(a){a=!0===a?this:new e(this);a._s=-a._s;return a};e.prototype.invm=function(a){return r(this,(new e(1)).div(this),a)};e.prototype.ceil=function(a){return(!0===a?this:new e(this)).inva(!0).floor(!0).inva(!0)};
e.prototype.intp=function(a){a=!0===a?this:new e(this);return 0<=a._s?a.floor(!0):a.ceil(!0)};e.prototype.eq=function(a,d){return 0===this.cmp(a,d)};e.prototype.min=function(a,d){return r(this,new e(0>=this.cmp(a)?this:a),d)};e.prototype.max=function(a,d){return r(this,new e(0<=this.cmp(a)?this:a),d)};e.prototype.sqrt=function(a){var d=new e(this);d._d.push(0);d._d.push(0);var b=new e(d),c=new e(d),f=new e(2);if(-1===c._s)throw new MbnErr(".sqrt","square root of negative number",this);if(1===c._s){do b.set(c),
c.add(d.div(c),!0).div(f,!0);while(!b.eq(c))}w(c);return r(this,c,a)};e.prototype.sgn=function(a){return r(this,new e(this._s),a)};e.prototype.pow=function(a,d){var b=new e(a);if(!b.isInt())throw new MbnErr(".pow","only integer exponents supported",b);var c=b._s;b._s*=b._s;var f=new e(1),k=new e(2);-1===c&&-1===this.abs().cmp(f)&&(this.invm(!0),c=-c);for(var t=new e(this),h=0,m=0,n=new e(f);!t.isInt();)t._d.push(0),v(t),h++;for(;1===b._s;){b._d[b._d.length-g-1]%2&&(n.mul(t,!0),b.sub(f,!0),m+=h);b.div(k,
!0).intp(!0);if(1!==b._s)break;t.mul(t,!0);h*=2}1<=m&&(1<m&&(n._d=n._d.slice(0,1-m)),w(n));-1===c&&n.invm(!0);return r(this,n,d)};var B={abs:1,inva:1,invm:1,ceil:1,floor:1,sqrt:1,round:1,sgn:1,intp:1,add:2,mul:2,min:2,max:2};e.reduce=function(a,d){if(!B.hasOwnProperty(a))throw new MbnErr(".reduce","invalid function name",a);if(!(d instanceof Array))throw new MbnErr(".reduce","argument is not array",d);var b,c=d.length;if(1===B[a]){b=[];for(var f=0;f<c;f++)b.push((new e(d[f]))[a](!0))}else for(b=new e(0<
c?d[0]:0),f=1;f<c;f++)b[a](d[f],!0);return b};var x={PI:"3.1415926535897932384626433832795028841972",E:"2.7182818284590452353602874713526624977573",MbnP:g},E=/^[A-Z]\w*$/;e["const"]=function(a,d){if(null===a.match(E))throw new MbnErr(".const","incorrect name",a);if(void 0===d){if(x.hasOwnProperty(a))return d=x[a],d instanceof e||(d=new e(d),x[a]=d),new e(d);throw new MbnErr(".const","undefined constant",a);}if(x.hasOwnProperty(a))throw new MbnErr(".const","constant allready set",a);d=new e(d);x[a]=
d;return new e(d)};var y={abs:!0,inva:!1,ceil:!0,floor:!0,sqrt:!0,round:!0,sgn:!0,"int":"intp"};p=["bop","pc"];var z=["num","name","uop","po"],F={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"]},A={num:{rx:/^([0-9\.,]+)\s*/,next:p.concat("pr"),end:!0},name:{rx:/^([A-Za-z_]\w*)\s*/},fn:{next:["po"],end:!1},vr:{next:p,end:!0},bop:{rx:/^([-+\*\/#^&|])\s*/,next:z,end:!1},uop:{rx:/^([-+])\s*/,next:z,end:!1},po:{rx:/^(\()\s*/,
next:z,end:!1},pc:{rx:/^(\))\s*/,next:p,end:!0},pr:{rx:/^(%)\s*/,next:p,end:!0}},G=/^\s+/;e.eval=function(a,d){a=a.replace(G,"");var b={};if(void 0!==d)for(var c in d)d.hasOwnProperty(c)&&(b[c]=new e(d[c]));var f=z,k=f.length;c=!1;for(var g=[],h=[],m=!1,n=null,l,p=[4,!0,"inva"];0<a.length;){l=null;for(c=0;c<k&&null===l;c++)n=f[c],l=a.match(A[n].rx);if(null===l)if("bop"===f[0])c="*",n="bop";else throw new MbnErr(".eval","unexpected",a);else c=l[1],a=a.slice(l[0].length);"uop"!==n&&m&&(h.push(p),m=
!1);switch(n){case "num":g.push(new e(c));break;case "name":if(y.hasOwnProperty(c)&&!1!==y[c])n="fn",h.push([4,!0,c]);else if(b.hasOwnProperty(c))n="vr",g.push(new e(b[c]));else if(x.hasOwnProperty(c))n="vr",g.push(e["const"](c));else throw new MbnErr(".eval","undefined",c);break;case "bop":for(c=F[c];-1!==(f=h.length-1);)if(k=h[f],"("!==k&&k[0]>c[0]-(c[1]?1:0))g.push(h.pop()[2]);else break;h.push(c);break;case "uop":"-"===c&&(m=!m);break;case "po":h.push(c);break;case "pc":for(;-1!==(f=h.length-
1);)if(k=h[f],"("!==k)g.push(h.pop()[2]);else{h.pop();break}if(-1===f)throw new MbnErr(".eval","unexpected",")");f=h.length-1;-1!==f&&4===h[f][2]&&g.push(h.pop()[2]);break;case "pr":g[g.length-1].div(100,!0)}f=A[n].next;k=f.length;c=A[n].end}for(;0!==h.length;)if(b=h.pop(),"("!==b)g.push(b[2]);else throw new MbnErr(".eval","unexpected","(");if(!c)throw new MbnErr(".eval","unexpected","END");h=[];b=g.length;for(c=0;c<b;c++)m=g[c],m instanceof e?h.push(m):y.hasOwnProperty(m)?("string"===typeof y[m]&&
(m=y[m]),h[h.length-1][m](!0)):(n=h.pop(),h[h.length-1][m](n,!0));return h[0]};return e},Mbn=MbnCr();