/* Mbn v1.52.1 / 06.09.2025 | https://mbn.li | Copyright (c) 2016-2025 Mikołaj Błajek | https://mbn.li/LICENSE */
"use strict";var Mbn=function(){function a(n,t,e,i,r,s,o,a){if(k(n,"MbnP")&&("number"!=typeof(t=n.MbnP)||t<0||!isFinite(t)||Math.round(t)!==t))throw new z(a+"invalid_precision",t);if(k(n,"MbnS")&&"."!==(e=n.MbnS)&&","!==e)throw new z(a+"invalid_separator",e);if(k(n,"MbnT")&&!0!==(i=n.MbnT)&&!1!==i)throw new z(a+"invalid_truncation",i);if(k(n,"MbnE")&&!0!==(r=n.MbnE)&&!1!==r&&null!==r)throw new z(a+"invalid_evaluating",r);if(k(n,"MbnF")&&!0!==(s=n.MbnF)&&!1!==s)throw new z(a+"invalid_formatting",s);if(k(n,"MbnL")&&("number"!=typeof(o=n.MbnL)||o<=0||!isFinite(o)||Math.round(o)!==o))throw new z(a+"invalid_limit",o);return{MbnV:l,MbnP:t,MbnS:e,MbnT:i,MbnE:r,MbnF:s,MbnL:o}}function n(n){function d(n,t,e){return!0===e?(n._d=t._d,n._s=t._s,n):t}function t(n,t,e,i,r){var s,o=n,a=n._d.length-c,f=(t<c&&(d=(s=new v(n))._d.length,t<c-1&&(s._d=s._d.slice(0,d-c+t+1)),_(s),a<(d=s._d.length)-t&&(s._d=s._d.slice(d-t-a)),o=s),o._d.slice(0,a));if(r)for(var u=f.length,l=0;3*l<u-3;l++)f.splice(-3-4*l,0," ");var h=o._d.slice(a);if(c<t&&!i)for(l=0;l<t-c;l++)h.push(0);if(i){for(l=h.length-1;0<=l&&0===h[l];l--);h=h.slice(0,l+1)}var d=(n._s<0?"-":"")+f.join("");return 0<h.length&&(d+=e+h.join("")),d}function v(n,t){if(!(this instanceof v))return new v(n,t);switch(this._s=1,this._d=[],typeof n){case"undefined":n=!1;case"boolean":n=Number(n);case"number":var e=this,i=n;if(!isFinite(i)){if(isNaN(i))throw new z("invalid_argument",i);throw new z("limit_exceeded",u)}i<0&&(i=-i,e._s=-1);for(var r,s,o,a=Math.floor(i),f=i-a;s=Math.round(a%10),a=Math.round((a-s)/10),e._d.unshift(s),0<a;);for(o=0;o<=c;o++)f*=10,r=Math.floor(f),e._d.push(s=10===r?9:r),f-=s;return void _(e);case"bigint":case"object":if(n instanceof v)return void this.set(n);if(n instanceof Array)throw new z("invalid_argument",n);n=null!==n?String(n):"0";case"string":!function(n,t,e){for(var i,r=t.match(w),s=r[3],o=("-"===r[2]&&(n._s=-1),(s.indexOf(".")+1||s.indexOf(",")+1)-1),a=s.length,f=a,u=(-1===o?o=a:f=o+1,Math.max(f+c,a)),l=0,h=0;h<=u;h++)if(0<=(i=h<a?s.charCodeAt(h)-48:0)&&i<=9)h<=f+c&&n._d.push(i);else{if(!(h===o&&1!==a||-16==i&&l<h&&h+1<o)){if(!0===e||e instanceof Object||!1!==e&&(!0===p||null===p&&"="===r[1]))return n.set(S(t,e,null));throw new z("invalid_format",t)}-16==i&&(l=h+1)}_(n)}(this,n,t);break;default:throw new z("invalid_argument",n)}}var c=(n=a(n="object"!=typeof n?void 0!==n?{MbnP:n}:{}:n,2,".",!1,null,!1,1e3,"extend.")).MbnP,e=n.MbnS,i=n.MbnT,p=n.MbnE,r=n.MbnF,u=n.MbnL,f=function(n){for(var t,e,i,r=n._d,s=r.length-1,o=s;0<=o;){for(t=r[o];t<0;)t+=10,r[o-1]--;i=(t-(e=t%10))/10,r[o]=e,0!=i?0!==o?r[--o]+=i:(r.unshift(i),s++):o--}for(;c<s&&0===r[0];)r.shift(),s--;for(;s<c;)r.unshift(0),s++;if(s===c){for(o=0;o<=s&&0===r[o];o++);n._s*=o<=s?1:0}else if(u<s-c)throw new z("limit_exceeded",u)},_=function(n){var t=n._d,e=t.length;e<2&&(t.unshift(0),e++),5<=t.pop()&&t[e-2]++,f(n)},w=/^\s*(=)?[\s=]*([-+])?\s*((?:[\s\S]*\S)?)/,b=(v.prop=function(){return{MbnV:l,MbnP:c,MbnS:e,MbnT:i,MbnE:p,MbnF:r,MbnL:u}},v.prototype.set=function(n){return n instanceof v?(this._d=n._d.slice(),this._s=n._s):d(this,new v(n),!0),this},v.prototype.toString=function(){return t(this,c,e,i,r)},v.prototype.format=function(n){return n=a(n="object"!=typeof n?{MbnF:0===arguments.length||n}:n,c,e,i,p,r,u,"format."),t(this,n.MbnP,n.MbnS,n.MbnT,n.MbnF)},v.prototype.toNumber=function(){return Number(t(this,c,"."))},v.prototype.cmp=function(n,t){var e;if(n instanceof v||(n=new v(n)),void 0===t||0===(e=new v(t))._s){if(this._s!==n._s)return this._s>n._s?1:-1;if(0!==this._s){var i=n._d.length,t=this._d.length-i;if(0!=t)return 0<t?this._s:-this._s;for(var r=0;r<i;r++)if(this._d[r]!==n._d[r])return this._d[r]>n._d[r]?this._s:-this._s}return 0}if(-1===e._s)throw new z("cmp.negative_diff",e);return this.sub(n).abs().cmp(e)<=0?0:this.cmp(n)},v.prototype.add=function(n,t){n instanceof v||(n=new v(n));var e=new v(n);if(0!==this._s)if(0===n._s)e.set(this);else if(n._s===this._s){var i=this._d.length-n._d.length;i<0?(n=this,i=-i):e.set(this);for(var r=0;r<e._d.length;r++)i<=r&&(e._d[r]+=n._d[r-i]);f(e)}else e._s=-e._s,e.sub(this,!0),e._s=-e._s;return d(this,e,t)},v.prototype.sub=function(n,t){n instanceof v||(n=new v(n));var e=new v(n);if(0===this._s)e._s=-e._s;else if(0===n._s)e.set(this);else if(n._s===this._s){var i=this._d.length-n._d.length,r=this.cmp(n)*this._s;if(0==r)e=new v(0);else{-1==r?(n=this,i=-i):e.set(this);for(var s=0;s<e._d.length;s++)i<=s&&(e._d[s]-=n._d[s-i]);e._s=r*this._s,f(e)}}else e._s=-e._s,e.add(this,!0);return d(this,e,t)},v.prototype.mul=function(n,t){n instanceof v||(n=new v(n));var e=new v(n);e._d=[];for(var i=0;i<this._d.length;i++)for(var r=0;r<n._d.length;r++)e._d[i+r]=this._d[i]*n._d[r]+(e._d[i+r]||0);return e._s=this._s*n._s,f(e),1<=c&&(1<c&&(e._d=e._d.slice(0,1-c)),_(e)),d(this,e,t)},v.prototype.div=function(n,t){if(0===(n=n instanceof v?n:new v(n))._s)throw new z("div.zero_divisor");if(0===this._s)return d(this,new v(this),t);for(var e=this._d.slice(),i=n._d.slice(),r=0,s=[0];0===i[0];)i.shift();for(;0===e[0];)e.shift();for(var o,a,f=c+1;i.length<e.length;)i.push(0),f++;do{for(;e[(o=e.length)-1]+i[(a=i.length)-1]===0;)e.pop(),i.pop();var u=a<=o;if(o===a)for(h=0;h<o;h++)if(e[h]!==i[h]){u=e[h]>i[h];break}if(u){s[r]++;for(var l=o-a,h=a-1;0<=h;h--)e[h+l]<i[h]?(e[h+l-1]--,e[h+l]+=10-i[h]):e[h+l]-=i[h]}else e.push(0),s[++r]=0;for(;0===e[0];)e.shift()}while(0!==e.length&&r<=f);for(;r<=f;)s[++r]=0;s.pop();n=new v(n);return n._s*=this._s,n._d=s,_(n),d(this,n,t)},v.prototype.mod=function(n,t){var n=(n instanceof v?n:new v(n)).abs(),e=this.sub(this.div(n).intp().mul(n));return e._s*this._s==-1&&((e=n.sub(e.abs()))._s=this._s),d(this,e,t)},v.prototype.split=function(n){var t,e=[];if((n=void 0===n?2:n)instanceof Array){for(var i=new v(10).pow(c),r=(a=new v(0),t=n.length,[!1,!1,!1]),s=0;s<t;s++){var o=new v(n[s]).mul(i);r[o._s+1]=!0,a.add(o,!0),e.push([s,o])}r[0]&&r[2]&&e.sort(function(n,t){return a._s*n[1].cmp(t[1])})}else{var a,f=new v(1);if(!(a=new v(n)).isInt())throw new z("split.invalid_part_count",n);for(t=a.toNumber(),s=0;s<t;s++)e.push([s,f])}if(t<=0)throw new z("split.invalid_part_count",t);if(0===a._s)throw new z("split.zero_part_sum");var u=new v(this),l=[];for(l.length=t,s=0;s<t;s++){var h,d,p=e[s][0];0===(d=e[s][1])._s?l[p]=d:(h=u.mul(d).div(a),a.sub(d,!0),u.sub(h,!0),l[p]=h)}return l},v.prototype.isInt=function(){for(var n=this._d.length-c;n<this._d.length;n++)if(0!==this._d[n])return!1;return!0},v.prototype.floor=function(n){var t=!0===n?this:new v(this);if(0!==c){for(var e=0,i=t._d.length-c;i<t._d.length;i++)e+=t._d[i],t._d[i]=0;-1===t._s&&0<e&&t._d[t._d.length-c-1]++,f(t)}return t},v.prototype.round=function(n){var t=!0===n?this:new v(this);if(0!==c){var e=t._d.length-c;for(t._d[e-1]+=5<=t._d[e]?1:0;e<t._d.length;)t._d[e++]=0;f(t)}return t},v.prototype.abs=function(n){n=!0===n?this:new v(this);return n._s*=n._s,n},v.prototype.inva=function(n){n=!0===n?this:new v(this);return n._s=-n._s,n},v.prototype.invm=function(n){return d(this,new v(1).div(this),n)},v.prototype.ceil=function(n){return(!0===n?this:new v(this)).inva(!0).floor(!0).inva(!0)},v.prototype.intp=function(n){n=!0===n?this:new v(this);return 0<=n._s?n.floor(!0):n.ceil(!0)},v.prototype.eq=function(n,t){return 0===this.cmp(n,t)},v.prototype.min=function(n,t){return d(this,new v(this.cmp(n)<=0?this:n),t)},v.prototype.max=function(n,t){return d(this,new v(0<=this.cmp(n)?this:n),t)},v.prototype.sqrt=function(n){var t=this.mul(100),e=t.add(0);if(-1===e._s)throw new z("sqrt.negative_value",this);if(1===e._s){for(var i,r=new v(2),s=null,o=0;i=s,s=e.add(0).sub(e.add(t.div(e),!0).div(r,!0),!0),o+=i&&s._s*i._s==-1?1:0,0!==s._s&&o<4;);_(e)}return d(this,e,n)},v.prototype.sgn=function(n){return d(this,new v(this._s),n)},v.prototype.pow=function(n,t){n=new v(n);if(!n.isInt())throw new z("pow.unsupported_exponent",n);for(var e=n._s,i=(n._s*=n._s,n.toNumber()),n=new v(1),r=new v(this),s=(-1===e&&-1===r.abs().cmp(n)&&(r.invm(!0),e=-e),0),o=0,a=new v(n);!r.isInt();)r._d.push(0),f(r),s++;for(;;){if(i%2==1&&(a.mul(r,!0),o+=s),0===(i=Math.floor(i/2)))break;r.mul(r,!0),s*=2}return 1<=o&&(1<o&&(a._d=a._d.slice(0,1-o)),_(a)),-1===e&&a.invm(!0),d(this,a,t)},v.prototype.fact=function(n){if(!this.isInt()||-1===this._s)throw new z("fact.invalid_value",this);for(var t=this.sub(1),e=this.max(1);1===t._s;)e.mul(t,!0),t.sub(1,!0);return d(this,e,n)},{set:0,abs:1,inva:1,invm:1,ceil:1,floor:1,sqrt:1,round:1,sgn:1,intp:1,fact:1,min:2,max:2,add:2,sub:2,mul:2,div:2,mod:2,pow:2}),s=(v.reduce=function(n,t,e){var i,r=!1;if(!k(b,n))throw new z("reduce.invalid_function",n);if(!(t instanceof Array)){if(!(e instanceof Array))throw new z("reduce.no_array");r=e,e=t,t=r}var s=t.length,o=b[n],a=3===arguments.length?e instanceof Array?2:1:0;if(2!==o&&0!=a)throw new z("reduce.invalid_argument_count");if(2===o&&0==a)for(i=new v(0<s?t[0]:0),u=1;u<s;u++)i[n](t[u],!0);else{if(i=[],2==a&&s!==e.length)throw new z("reduce.different_lengths",{v:s,w:e.length},!0);for(var f=1==a?new v(e):null,u=0;u<s;u++){var l,h=new v(t[u]);0!=a&&(l=2==a?new v(e[u]):f,h.set(!1===r?h[n](l):l[n](h))),i.push(1===o?h[n](!0):h)}}return i},{PI:"3.1415926535897932384626433832795028841972",E:"2.7182818284590452353602874713526624977573",eps:!0}),o=/^[A-Za-z_]\w*/,g={abs:!0,inva:!(v.def=function(n,t){var e=null===n;if(!o.test(e?t:n))throw new z("def.invalid_name",e?t:n);if(e)return k(s,t);if(void 0===t){if(k(s,n))return s[n]instanceof v||(s[n]="eps"===n?new v(10).pow(-c):new v(s[n])),new v(s[n]);throw new z("def.undefined",n)}if(k(s,n))throw new z("def.already_set",{v:n,w:new v(s[n])},!0);return t=new v(t),s[n]=t,new v(t)}),ceil:!0,floor:!0,fact:!0,sqrt:!0,round:!0,sgn:!0,int:"intp",div_100:"div_100"},m={endBop:["bop","pc","fs"],uopVal:["num","name","uop","po"],fn:["po"]},y={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"],"%":[7,!0,"div_100"],"!":[7,!0,"fact"],inva:[6,!0,"inva"],fn:[7,!0]},M={num:{rx:/^([0-9., ]+)\s*/,next:m.endBop},name:{rx:/^([A-Za-z_]\w*)\s*/},fn:{next:m.fn},vr:{next:m.endBop},bop:{rx:/^([-+*\/#^&|])\s*/,next:m.uopVal},uop:{rx:/^([-+])\s*/,next:m.uopVal},po:{rx:/^(\()\s*/,next:m.uopVal},pc:{rx:/^(\))\s*/,next:m.endBop},fs:{rx:/^([%!])\s*/,next:m.endBop}},x=/^[\s=]+/,S=(v.calc=function(n,t){return new v(n,!(t instanceof Object)||t)},v.check=function(n,t){try{var e,i=S(n,!1,!0===t),r=[];for(e in i)k(i,e)&&(r[i[e]]=e);return r}catch(n){return!1}},function(n,t,e){var i=String(n),r={size:0,vars:{}};t instanceof Object||(t={});for(var s,o,a,f,u={r0:new v};s=i.match(/{+/);)s=s[0],o=i.indexOf(s),a=i.indexOf(s.replace(/{/g,"}"),o),i=i.slice(0,o)+(-1===a?"":"\t"+i.slice(a+s.length));for(var l=i.split(";"),h=0;h<l.length;h++)for(i=l[h].replace(x,""),u["r"+(h+1)]=u.r0=""===i?u.r0:j(i,t,u,r,e),f=0;f<=h;f++)u["r0"+(f+1)]=u["r"+(h-f+1)];return null===e?u.r0:r.vars}),j=function(n,t,e,i,r){for(var s,o,a,f,u=m.uopVal,l=[],h=[];""!==n;){for(a=null,_=0;_<u.length&&null===a;_++)s=u[_],a=n.match(M[s].rx);if(null!==a)o=a[1],n=n.slice(a[0].length);else{if(u!==m.endBop||n.match(M.num.rx))throw new z("calc.unexpected",n);o="*",s="bop"}switch(s){case"num":l.push(new v(o,!1));break;case"name":if(s="vr",k(g,o)&&!1!==g[o])s="fn",h.push(y.fn.concat([o]));else if(null!==r)k(i.vars,o)||r&&(k(e,o)||v.def(null,o))||(i.vars[o]=i.size++);else if(k(t,o))k(i.vars,o)||(i.vars[o]=new v(t[o])),l.push(new v(i.vars[o]));else if(k(e,o))l.push(new v(e[o]));else{if(!v.def(null,o))throw new z("calc.undefined",o);l.push(v.def(o))}break;case"fs":case"bop":for(var d=y[o];void 0!==(f=h.pop());){if("("===f||f[0]<=d[0]-(d[1]?1:0)){h.push(f);break}l.push(f[2])}h.push(d);break;case"uop":"-"===o&&h.push(y.inva);break;case"po":h.push(o);break;case"pc":for(;"("!==(f=h.pop());){if(void 0===f)throw new z("calc.unexpected",")");l.push(f[2])}}u=M[s].next}for(;void 0!==(f=h.pop());){if("("===f)throw new z("calc.unexpected","(");l.push(f[2])}if(u!==m.endBop)throw new z("calc.unexpected","END");if(null!==r)return null;for(var p,c=[],_=0;_<l.length;_++)(p=l[_])instanceof v?c.push(p):k(g,p)?"string"==typeof g[p]&&-1!==(p=g[p]).indexOf("_")?(p=p.split("_"),c[c.length-1][p[0]](p[1],!0)):c[c.length-1][p](!0):c[c.length-2][p](c.pop(),!0);return c[0]};return v}var h={invalid_argument:"invalid argument: %v%",invalid_format:"invalid format: %v%",limit_exceeded:"value exceeded %v% digits limit",calc:{undefined:"undefined: %v%",unexpected:"unexpected: %v%"},cmp:{negative_diff:"negative maximal difference: %v%"},def:{undefined:"undefined constant: %v%",already_set:"constant already set: %v% = %w%",invalid_name:"invalid name for constant: %v%"},div:{zero_divisor:"division by zero"},extend:{invalid_precision:"invalid precision (non-negative integer): %v%",invalid_separator:"invalid separator (dot, comma): %v%",invalid_truncation:"invalid truncation (bool): %v%",invalid_evaluating:"invalid evaluating (bool, null): %v%",invalid_formatting:"invalid formatting (bool): %v%",invalid_limit:"invalid digit limit (positive int): %v%"},fact:{invalid_value:"factorial of invalid value (non-negative integer): %v%"},format:{_:"extend"},pow:{unsupported_exponent:"only integer exponents supported: %v%"},reduce:{invalid_function:"invalid function name: %v%",no_array:"no array given",invalid_argument_count:"two arguments can be used only with two-argument functions",different_lengths:"arrays have different lengths: %v%, %w%",different_keys:"arrays have different keys: [%v%], [%w%]"},split:{invalid_part_count:"only positive integer number of parts supported: %v%",zero_part_sum:"cannot split value when sum of parts is zero"},sqrt:{negative_value:"square root of negative value: %v%"}},d=null,k=function(n,t){return h.hasOwnProperty.call(n,t)},p=function(n,t){if(n instanceof Array){var e,i=[];if(void 0===t||!0===t)for(e=0;e<n.length;e++)i.push(p(n[e],!1));else i.push("..");return"["+i.join(",")+"]"}return"string"==typeof n?'"'+n+'"':String(n)},z=function(n,t,e){var i,r={};if(1!==arguments.length)for(u in t="object"==typeof t&&!0===e?t:{v:t})k(t,u)&&(i=p(t[u]),r[u]=20<i.length?i.slice(0,18)+"..":i);this.errorKey="mbn."+n,this.errorValues=r;var s=null;if("function"==typeof d)try{s=d(this.errorKey,r)}catch(n){}if("string"!=typeof s){for(var o=n.split("."),a=o.length,s="Mbn",f=(1<a&&(s+="."+o[0]),h),u=0;u<a;u++)var l=f[o[u]],f=l="object"==typeof l&&k(l,"_")?f[l._]:l;s+=" error: "+f}for(u in r)k(r,u)&&(s=s.replace("%"+u+"%",r[u]));this.message=s},l=(z.prototype.toString=function(){return this.message},z.translate=function(n){d=n},"1.52.1"),t=n();return t.extend=n,t.MbnErr=z,t}();"object"==typeof module&&(module.exports.default=module.exports=Mbn);
