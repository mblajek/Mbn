var MbnErr=function(k,g,q){this.toString=function(){return"Mbn"+k+" error: "+g+(void 0!==q?": "+q:"")}},MbnCr=function(k){"object"!==typeof k&&(k=void 0!==k?{MbnP:Number(k)}:{});var g=void 0===k.MbnP?2:Number(k.MbnP);if(!isFinite(g)||Math.round(g)!==g||0>g)throw new MbnErr("Cr","invalid precision",g);var q=void 0===k.MbnS?".":k.MbnS;if("."!==q&&","!==q)throw new MbnErr("Cr","invalid separator",q);var y=void 0===k.MbnT?!1:k.MbnT;if(!0!==y&&!1!==y)throw new MbnErr("Cr","invalid truncate",y);var u={PI:"3.1415926535897932384626433832795028841972",
E:"2.7182818284590452353602874713526624977573",MbnP:g},v=function(a){for(var d=a._d,b=d.length-1,c,e;0<=b;){for(c=d[b];0>c;)c+=10,d[b-1]--;e=c%10;c=(c-e)/10;d[b]=e;c?b?d[--b]+=c:d.unshift(c):b--}for(;d.length>g+1&&0===d[0];)d.shift();for(;d.length<g+1;)d.unshift(0);if(d.length===g+1){for(b=0;b<=g&&0===d[b];b++);a._s*=b<=g?1:0}},n=function(a,d,b){return!0===b?(a._d=d._d,a._s=d._s,a):d},x=function(a){r=a._d;r[r.length-2]+=5<=r.pop()?1:0;v(a)},d=function(a,f){if(!(this instanceof d))return new d(a,f);
switch(typeof a){case "undefined":a=0;case "number":var b=a;if(!isFinite(b))throw new MbnErr("","invalid value",b);this._s=1;this._d=[];0>b&&(b=-b,this._s=-1);var c=Math.floor(b),b=b-c;do{var e=c%10,c=c-e,c=c/10;this._d.unshift(e)}while(0<c);for(c=0;c<=g;c++)b*=10,e=Math.floor(b),e=10===e?9:e,this._d.push(e),b-=e;x(this);break;case "object":if(a instanceof d){this.set(a);break}a=a.toString(q);case "string":a:{c=b=a;this._s=1;this._d=[];n0=b.charAt(0);if("-"===n0||"+"===n0||"="===n0)if(this._s="-"===
n0?-1:1,b=b.slice(1),"="===n0){this.set(d.eval(b,f));break a}ln=(b.indexOf(".")+1||b.indexOf(",")+1)-1;if(-1===ln)ln=b.length;else if(b=b.slice(0,ln)+b.slice(ln+1),ln===b.length)throw new MbnErr("","invalid format",c);0===ln&&(ln=1,b="0"+b);for(var w=b.length,t=0;t<=ln+g;t++)if(e=t<w?b.charCodeAt(t)-48:0,0<=e&&9>=e)this._d.push(e);else throw new MbnErr("","invalid format",c);x(this)}break;default:throw new MbnErr("","invalid argument",a);}};d.prop=function(){return{MbnV:"1.9",MbnP:g,MbnS:q,MbnT:y}};
d.prototype.toString=function(){var a=this._d.length-g,d;if(y){d=a-1;for(var b=a;b<this._d.length;b++)0!==this._d[b]&&(d=b)}else d=a+g;b=(0>this._s?"-":"")+this._d.slice(0,a).join("");0!==g&&d>=a&&(b+=q+this._d.slice(a,d+1).join(""));return b};d.prototype.toNumber=function(){return Number(String(this).replace(",","."))};d.prototype.cmp=function(a,f){var b;if(void 0===f||0===(b=new d(f))._s){a instanceof d||(a=new d(a));if(this._s!==a._s)return this._s>a._s?1:-1;if(0===this._s)return 0;b=this._d.length-
a._d.length;if(0!==b)return 0<b?this._s:-this._s;for(b=0;b<this._d.length;b++)if(this._d[b]!==a._d[b])return this._d[b]>a._d[b]?this._s:-this._s;return 0}if(-1===b._s)throw new MbnErr(".cmp","negative maximal difference");return 0>=this.sub(a).abs().cmp(b)?0:this.cmp(a)};d.prototype.add=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0!==this._s)if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length;0>c?(a=this,c=-c):b.set(this);for(var e=0;e<b._d.length;e++)e>=
c&&(b._d[e]+=a._d[e-c]);v(b)}else b._s=-b._s,b.sub(this,!0),b._s=-b._s;return n(this,b,f)};d.prototype.sub=function(a,f){a instanceof d||(a=new d(a));var b=new d(a);if(0===this._s)b._s=-b._s;else if(0===a._s)b.set(this);else if(a._s===this._s){var c=this._d.length-a._d.length,e=this.cmp(a)*this._s;if(0===e)b=new d("0");else{-1===e?(a=this,c=-c):b.set(this);for(var g=0;g<b._d.length;g++)g>=c&&(b._d[g]-=a._d[g-c]);b._s=e*this._s;v(b)}}else b._s=-b._s,b.add(this,!0);return n(this,b,f)};d.prototype.mul=
function(a,f){a instanceof d||(a=new d(a));var b=new d(a);b._d=[];for(var c=0;c<this._d.length;c++)for(var e=0;e<a._d.length;e++)b._d[c+e]=this._d[c]*a._d[e]+(b._d[c+e]||0);b._s=this._s*a._s;v(b);1<=g&&(1<g&&(b._d=b._d.slice(0,1-g)),x(b));return n(this,b,f)};d.prototype.div=function(a,f){a instanceof d||(a=new d(a));if(0===a._s)throw new MbnErr(".div","division by zero");if(0===this._s)return n(this,new d(this),f);for(var b=this._d.slice(),c=a._d.slice(),e=0,w=[0];0===c[0];)c.shift();for(;0===b[0];)b.shift();
for(var t=g+1;c.length<b.length;)c.push(0),t++;var h,l;do{for(;0===b[(h=b.length)-1]+c[(l=c.length)-1];)b.pop(),c.pop();var k=h>=l;if(h===l)for(var m=0;m<h;m++)if(b[m]!==c[m]){k=b[m]>c[m];break}if(k)for(w[e]++,h-=l,m=l-1;0<=m;m--)b[m+h]<c[m]?(b[m+h-1]--,b[m+h]+=10-c[m]):b[m+h]-=c[m];else b.push(0),e++,w[e]=0;for(;0===b[0];)b.shift()}while(0!==b.length&&e<=t);for(;e<=t;)w[++e]=0;w.pop();b=new d(a);b._s*=this._s;b._d=w;x(b);return n(this,b,f)};d.prototype.mod=function(a,f){var b=a instanceof d?a.abs():
(new d(a)).abs(),c=this.sub(this.div(b)["int"]().mul(b));0===c._s+this._s&&(c=b.sub(c.abs()),c._s=this._s);return n(this,c,f)};d.prototype.split=function(a){var f,b;void 0===a&&(a=2);if(a instanceof Array)for(f=[],b=new d(0),e=0;e<a.length;e++)f.push(new d(a[e])),b.add(f[e],!0);else{var c=new d(1);f=[];b=new d(a);if(!b.isInt()||0>b._s)throw new MbnErr(".split","only natural number of parts supported");a=b.toNumber();for(var e=0;e<a;e++)f.push(c)}if(0===f.length)return[];c=new d(this);a=[];for(e=0;e<
f.length-1;e++){var g=c.mul(f[e]).div(b);b.sub(f[e],!0);c.sub(g,!0);a.push(g)}a.push(c);return a};d.prototype.isInt=function(){for(var a=this._d.length-g;a<this._d.length;a++)if(0!==this._d[a])return!1;return!0};d.prototype.pow=function(a,f){a=new d(a);if(!a.isInt())throw new MbnErr(".pow","only integer exponents supported");var b=a._s;a._s*=a._s;for(var c=new d(this),e=0,k=0,t=new d(1),h=new d(2),l=new d(t);!c.isInt();)c._d.push(0),v(c),e++;for(;1===a._s;){a._d[a._d.length-g-1]%2&&(l.mul(c,!0),a.sub(t,
!0),k+=e);a.div(h,!0)["int"](!0);if(1!==a._s)break;c.mul(c,!0);e*=2}1<=k&&(1<k&&(l._d=l._d.slice(0,1-k)),x(l));-1===b&&l.invm(!0);return n(this,l,f)};d.prototype.floor=function(a){a=!0===a?this:new d(this);if(0!==g){for(var f=0,b=a._d.length-g;b<a._d.length;b++)f+=a._d[b],a._d[b]=0;-1===a._s&&0<f&&a._d[a._d.length-g-1]++;v(a)}return a};d.prototype.round=function(a){a=!0===a?this:new d(this);if(0!==g){var f=a._d.length-g;for(a._d[f-1]+=5<=a._d[f]?1:0;f<a._d.length;)a._d[f++]=0;v(a)}return a};d.prototype.abs=
function(a){a=!0===a?this:new d(this);a._s*=a._s;return a};d.prototype.inva=function(a){a=!0===a?this:new d(this);a._s=-a._s;return a};d.prototype.invm=function(a){return n(this,(new d(1)).div(this),a)};d.prototype.ceil=function(a){return(!0===a?this:new d(this)).inva(!0).floor(!0).inva(!0)};d.prototype["int"]=function(a){a=!0===a?this:new d(this);return 0<=a._s?a.floor(!0):a.ceil(!0)};d.prototype.eq=function(a,d){return 0===this.cmp(a,d)};d.prototype.min=function(a,f){return n(this,new d(0>=this.cmp(a)?
this:a),f)};d.prototype.max=function(a,f){return n(this,new d(0<=this.cmp(a)?this:a),f)};d.prototype.sqrt=function(a){var f=new d(this);f._d.push(0);f._d.push(0);var b=new d(f),c=new d(f),e=new d(2);if(-1===c._s)throw new MbnErr(".sqrt","square root of negative number",this);if(1===c._s){do b.set(c),c.add(f.div(c),!0).div(e,!0);while(!b.eq(c))}x(c);return n(this,c,a)};d.prototype.sgn=function(a){return n(this,new d(this._s),a)};d.prototype.set=function(a){a instanceof d?(this._d=a._d.slice(),this._s=
a._s):this.set(new d(a));return this};d.PI=function(){return new d(u.PI)};d.E=function(){return new d(u.E)};d.MbnP=function(){return new d(u.MbnP)};var B={abs:1,inva:2,ceil:1,floor:1,invm:2,sqrt:1,round:1,sgn:1,"int":1};k=["bop","pc"];var z=["num","name","uop","po"],D={"|":[1,!0,"max"],"&":[2,!0,"min"],"+":[3,!0,"add"],"-":[3,!0,"sub"],"*":[4,!0,"mul"],"#":[4,!0,"mod"],"/":[4,!0,"div"],"^":[5,!1,"pow"]},A={num:{rx:/^([0-9]*[\.,]?[0-9]+)\s*/,next:k.concat("pr"),end:!0},name:{rx:/^([A-za-z_]\w*)\s*/},
fn:{next:["po"],end:!1},vr:{next:k,end:!0},bop:{rx:/^([-+\*\/#^&|])\s*/,next:z,end:!1},uop:{rx:/^([-+])\s*/,next:z,end:!1},po:{rx:/^(\()\s*/,next:z,end:!1},pc:{rx:/^(\))\s*/,next:k,end:!0},pr:{rx:/^(%)\s*/,next:k,end:!0}};d.eval=function(a,f){a=a.replace(/^\s+/,"");var b={};if(void 0!==f)for(var c in f)f.hasOwnProperty(c)&&(b[c]=new d(f[c]));var e=z,g=e.length;c=!1;for(var k=[],h=[],l=!1,p=null,m,n,q=[4,!0,"inva"];0<a.length;){m=p;n=null;for(c=0;c<g&&null===n;c++)p=e[c],n=a.match(A[p].rx);if(null===
n){if("bop"!==e[0]||"num"===m&&A.num.rx.test(a))throw new MbnErr(".eval","unexpected",a);c="*";p="bop"}else c=n[1],a=a.slice(n[0].length);"uop"!==p&&l&&(h.push(q),l=!1);switch(p){case "num":k.push(new d(c));break;case "name":if(B.hasOwnProperty(c)&&1===B[c])p="fn",h.push([4,!0,c]);else if(b.hasOwnProperty(c))p="vr",k.push(new d(b[c]));else if(u.hasOwnProperty(c))p="vr",k.push(new d(u[c]));else throw new MbnErr(".eval","undefined",c);break;case "bop":for(c=D[c];-1!==(e=h.length-1);)if(g=h[e],"("!==
g&&g[0]>c[0]-(c[1]?1:0))k.push(h.pop()[2]);else break;h.push(c);break;case "uop":"-"===c&&(l=!l);break;case "po":h.push(c);break;case "pc":for(;-1!==(e=h.length-1);)if(g=h[e],"("!==g)k.push(h.pop()[2]);else{h.pop();break}if(-1===e)throw new MbnErr(".eval","unexpected",")");e=h.length-1;-1!==e&&4===h[e][2]&&k.push(h.pop()[2]);break;case "pr":k[k.length-1].div(100,!0)}e=A[p].next;g=e.length;c=A[p].end}for(;0!==h.length;)if(b=h.pop(),"("!==b)k.push(b[2]);else throw new MbnErr(".eval","unexpected","(");
if(!c)throw new MbnErr(".eval","unexpected","END");h=[];b=k.length;for(c=0;c<b;c++)if(l=k[c],l instanceof d)h.push(l);else if(B.hasOwnProperty(l))h[h.length-1][l](!0);else p=h.pop(),h[h.length-1][l](p,!0);return h[0]};for(var C in u)u.hasOwnProperty(C)&&(u[C]=new d(u[C]));return d},Mbn=MbnCr();